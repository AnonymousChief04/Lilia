--------------------------------------------------------------------------------------------------------
local EXPLOIT_DESTROYER_SETTINGS = {
    COUNT = 4
}

--------------------------------------------------------------------------------------------------------
local ban = function(len, ply)
    ply:Ban(0, false)
    ply:Kick("No Exploits!")
end

--------------------------------------------------------------------------------------------------------
timer.Simple(
    1,
    function()
        for i = #lia.config.LokiNetMessages, 1, -1 do
            if util.NetworkStringToID(lia.config.LokiNetMessages[i]) ~= 0 then
                print(string.format("%s has been detected - be sure it's not exploitable", table.remove(lia.config.LokiNetMessages, i)))
            end
        end

        for i = 1, EXPLOIT_DESTROYER_SETTINGS.COUNT do
            local rand = table.remove(lia.config.LokiNetMessages, math.random(1, #lia.config.LokiNetMessages))
            if not rand then
                print("couldn't find unallocated loki netstring")
                break
            end

            util.AddNetworkString(rand)
            net.Receive(rand, ban)
            print(string.format("%s has been allocated to ban", rand))
        end
    end
)
--------------------------------------------------------------------------------------------------------